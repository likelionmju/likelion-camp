{% extends 'base.html' %}
{% load static %}

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% block link %}{% static 'stacklion/css/QnA.css' %}{% endblock %}
    {% block title %}Likelion Camp{% endblock %}
    {% block jqueryscript %}
        <script type="text/javascript">
            $(function () {
                $(".revise").click(function(){
                    var id = $(this).attr("id");
                    var content = $(#question_content+id).val();
                    console.log(content);
                });
            });
        </script>
    {% endblock %}
</head>

{% block content%}
    <body>
    <h1 style="text-align: center;">Question & Answer</h1>
    <div class="question_form">
        <h5>{{ user.name }}<a style="font-size: small; color:#E18A07">님의 질문</a></h5>
        <form action="{% url 'QnA' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <textarea class="question" name="question" rows="10" cols="50" placeholder="질문을 입력해주세요."></textarea><br>
            <input type="file" name="question_file" style="color : #E18A07; font-size: small;">
            <input class="button" type="submit" value="등록">
        </form>
    </div>

    {% for question in questions.all reversed %}
        <form action="{% url 'refresh' %}" method="post">
            <div id="{{ question.id }}" class="answer_form">
                <a style="background-color: rgb(216, 216, 216);">{{ question.asker }} / {{ question.pub_date }}</a>
                <div id="question_content+{{ question.id }}">{{ question.question_content }}</div>
                {% if question.asker == user %}
                    <div name="revise">
                        <button type="button" id="{{ question.id }}" class="button revise" value="수정">수정</button>
                        <button type="button" id="{{ question.id }}" class="button delete" value="삭제">삭제</button>
                    </div>
                {% endif %}

                {% if question.question_file.url != None %}
                    <div><a href="{{ question.question_file.url }}" download="">첨부파일 다운로드 {{ question.question_file }}</a> </div>
                {% endif %}

                <input type="hidden" value="{{ question.id }}" name="question_id">
                <textarea class="answer" name="answer" rows="2" cols="50" placeholder="답변을 입력해주세요."></textarea>
                {% csrf_token %}
                <br>
                <input type="submit" class="button" value="답변" >

                {% for answer in question.answers.all %}
                    <div name="comment">
                        {{ answer.answerer }} )
                        {{ answer.answer_content }}
                    </div>
                {% endfor %}
            </div>
        </form>
    {% endfor %}


    </body>
{% endblock %}


</html>